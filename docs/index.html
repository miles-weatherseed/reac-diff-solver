
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Introduction &#8212; reac-diff-solver 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">reac-diff-solver 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>This Python module provides a library for solving reaction-diffusion systems, using finite element and conjugate gradient methods. The general form of the systems is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\frac{\partial u}{\partial t} &amp;= \text{D}_u \nabla^{2} u + f(u,v) \\
\frac{\partial v}{\partial t} &amp;= \text{D}_v \nabla^{2} v + g(u,v)
\end{align*}\end{split}\]</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Clone the repo and install via pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">miles</span><span class="o">-</span><span class="n">weatherseed</span><span class="o">/</span><span class="n">reac</span><span class="o">-</span><span class="n">diff</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">git</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>See README for a detailed example on how to use the library.</p>
</div>
</div>
<div class="section" id="module-reac_diff_solver.conjgrad">
<span id="api-reference"></span><h1>API Reference<a class="headerlink" href="#module-reac_diff_solver.conjgrad" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="reac_diff_solver.conjgrad.conjugate_gradients">
<code class="sig-prename descclassname">reac_diff_solver.conjgrad.</code><code class="sig-name descname">conjugate_gradients</code><span class="sig-paren">(</span><em class="sig-param">A</em>, <em class="sig-param">b</em>, <em class="sig-param">x0</em>, <em class="sig-param">tol=0.0001</em>, <em class="sig-param">nmax=100</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.conjgrad.conjugate_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the conjugate gradient algorithm to solve the system Ax = b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>2d numpy array</em><em> or </em><em>scipy sparse matrix</em>) – symmetric, positive definite matrix</p></li>
<li><p><strong>b</strong> (<em>1d numpy array</em>) – right-hand side of the system</p></li>
<li><p><strong>x0</strong> (<em>1d numpy array</em>) – starting point of the iteration</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – tolerance, iteration terminates when the norm of the residual has been reduced by the tolerance</p></li>
<li><p><strong>nmax</strong> (<em>int</em>) – maximum number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – the matrix A is not square</p></li>
<li><p><strong>TypeError</strong> – the dimensions of A &amp; b don’t match</p></li>
<li><p><strong>TypeError</strong> – the dimensions of A &amp; x0 don’t match</p></li>
<li><p><strong>Exception</strong> – the iteration has failed to converge in nmax iterations</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>solution of the equation, list of the norm of the residual after each iteration</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple of 1d numpy array and a list of floats</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-reac_diff_solver.inference"></span><dl class="class">
<dt id="reac_diff_solver.inference.Inference">
<em class="property">class </em><code class="sig-prename descclassname">reac_diff_solver.inference.</code><code class="sig-name descname">Inference</code><span class="sig-paren">(</span><em class="sig-param">u_data</em>, <em class="sig-param">v_data</em>, <em class="sig-param">times</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.inference.Inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#reac_diff_solver.solver.Solver" title="reac_diff_solver.solver.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">reac_diff_solver.solver.Solver</span></code></a></p>
<dl class="method">
<dt id="reac_diff_solver.inference.Inference.cost_func">
<code class="sig-name descname">cost_func</code><span class="sig-paren">(</span><em class="sig-param">parametervalues</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.inference.Inference.cost_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes newly proposed set of parameter values and returns the L2 error between the values of u,v given by the
solver with these values and the values of u,v from the input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parametervalues</strong> – the proposed set of parameter values at this point in the optimization</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the L2 error with these parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.inference.Inference.fit_params">
<code class="sig-name descname">fit_params</code><span class="sig-paren">(</span><em class="sig-param">x0</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.inference.Inference.fit_params" title="Permalink to this definition">¶</a></dt>
<dd><p>The master function to call. Fits parameters from some initial estimate by minimizing the cost function using
the Nelder-Mead method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x0</strong> – the initial estimate of parameters</p>
</dd>
<dt class="field-even">Return best_fit_parameters</dt>
<dd class="field-even"><p>a vector of the fitted parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.inference.Inference.set_model">
<code class="sig-name descname">set_model</code><span class="sig-paren">(</span><em class="sig-param">xBounds</em>, <em class="sig-param">yBounds</em>, <em class="sig-param">initial_conditions_function</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.inference.Inference.set_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up the reaction diffusion model we wish to consider. We determine the x and y boundaries for consideration
and provide some initial conditions for our system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xBounds</strong> – x-range of the problem</p></li>
<li><p><strong>yBounds</strong> – y-range of the problem</p></li>
<li><p><strong>initial_condition_function</strong> (<em>function that takes two 2d numpy arrays and returns a list of two 2d numpy arrays</em>) – calculates the values of u and v at t=0 at each gridpoint</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.inference.Inference.set_reaction_function">
<code class="sig-name descname">set_reaction_function</code><span class="sig-paren">(</span><em class="sig-param">function</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.inference.Inference.set_reaction_function" title="Permalink to this definition">¶</a></dt>
<dd><p>This is optional. We can choose to provide a nonlinear term to our system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function</strong> (<em>function that takes two numpy arrays</em><em> (</em><em>containing values of u and v</em><em>) </em><em>and a list of parameters and returns a list of two numpy arrays</em>) – calculates the value of the reaction terms at the given u and v</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-reac_diff_solver.solver"></span><dl class="class">
<dt id="reac_diff_solver.solver.Solver">
<em class="property">class </em><code class="sig-prename descclassname">reac_diff_solver.solver.</code><code class="sig-name descname">Solver</code><span class="sig-paren">(</span><em class="sig-param">xBounds</em>, <em class="sig-param">yBounds</em>, <em class="sig-param">gridSize</em>, <em class="sig-param">initial_condition_function</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="reac_diff_solver.solver.Solver.set_grid">
<code class="sig-name descname">set_grid</code><span class="sig-paren">(</span><em class="sig-param">xBounds</em>, <em class="sig-param">yBounds</em>, <em class="sig-param">gridSize</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver.set_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the grid parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xBounds</strong> (<em>list of two floats</em>) – x-range of the problem</p></li>
<li><p><strong>yBounds</strong> (<em>list of two floats</em>) – y-range of the problem</p></li>
<li><p><strong>gridSize</strong> (<em>int</em>) – number of gridpoints to use (in both the x- &amp; y-direction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.solver.Solver.set_initialConditions">
<code class="sig-name descname">set_initialConditions</code><span class="sig-paren">(</span><em class="sig-param">initial_condition_function</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver.set_initialConditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the initial conditions used by the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>initial_condition_function</strong> (<em>function that takes two 2d numpy arrays and returns a list of two 2d numpy arrays</em>) – calculates the values of u and v at t=0 at each gridpoint</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.solver.Solver.set_reactionFunction">
<code class="sig-name descname">set_reactionFunction</code><span class="sig-paren">(</span><em class="sig-param">function</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver.set_reactionFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the reaction term of the equation (defaults to zero).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>function</strong> (<em>function that takes two numpy arrays</em><em> (</em><em>containing values of u and v</em><em>) </em><em>and a list of parameters and returns a list of two numpy arrays</em>) – calculates the value of the reaction terms at the given u and v</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.solver.Solver.set_timeStepLength">
<code class="sig-name descname">set_timeStepLength</code><span class="sig-paren">(</span><em class="sig-param">length</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver.set_timeStepLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the size of the timestep used by the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>length</strong> (<em>float</em>) – timestep</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="reac_diff_solver.solver.Solver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param">times</em>, <em class="sig-param">parameters</em>, <em class="sig-param">printProgress=False</em><span class="sig-paren">)</span><a class="headerlink" href="#reac_diff_solver.solver.Solver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the equation at the given times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>list of floats</em>) – times at which the solution is desired.</p></li>
<li><p><strong>parameters</strong> (<em>list</em>) – parameters to give to the reaction function</p></li>
<li><p><strong>printProgress</strong> – whether or not to print progress updates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the solution of u and v at the given times</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of two 2d numpy arrays (self.gridSize by self.gridSize)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-reac_diff_solver.conjgrad">API Reference</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">reac-diff-solver 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Barnum Swannell, Danail Stoychev, Miles Weatherseed, Muriel van der Laan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>